:root{
  --panel-top: 0px;        /* 由 JS 寫入：目前抽屜 top */
  --panel-head-h: 52px;    /* .scene-footer 高度（JS 會覆蓋） */
}

/*全頁框架容器*/
.page-wrapper {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
}

// /* ▲ Bootstrap container 會有左右 padding，會干擾 393×685 百分比定位 */
// .container.bg-scene{ padding-left:0; padding-right:0; }



/* 讓內容不被固定底列遮住 */
.has-bottom-pad { padding-bottom: calc(108px + env(safe-area-inset-bottom)); }

/* 背景容器：等比縮放，基準為 393×685 */
.bg-scene {
  width: 100%;
  max-width: 393px;
  aspect-ratio: 393 / 685;
  position: relative;
  
  // margin: 0 auto;
  //margin-top: -90px;    用來手動調整RWD版型問題 -90為小尺吋手機版
  background-image: url('/assets/images/bg/bg1.png');
  background-repeat:no-repeat;
  // background-position:center -90px;
  background-position:center;
  background-size:cover;
}

.mt-top {
  margin-top: 60px; //  用來手動調整RWD版型問題 100為小尺吋手機版
}

/* ZZZ 位置： inset（391/262/178/115） */
.speech {
  position: absolute;
  inset: 57.08% 29.26% 38.24% 45.29%; /* top(391/685) right(115/393)  bottom(262/685) left(178/393) */
  padding: 7.5px 6.5px;
}

/* 貓的槽位：把 px 轉百分比，RWD 不跑位 */
.cat-slot {
  position: absolute;
  /* 由 393×685 換算 */
  top: 59.27%;    /* 406 / 685 */
  left: 15.01%;   /* 59 / 393 */
  width: 53.19%;  /* 209 / 393 */
  height: 23.07%; /* 158 / 685 */
}
.cat-slot img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* 進度卡樣式 */
.task-card {
  /* 刪：background-color: rgba($primary-50, 0.33); */
  background:
    /* 上層：主色薄膜，輕度透 */
    linear-gradient(rgba($primary-50, .33), rgba($primary-50, .33)),
    /* 下層：淺底，中度透，主導視覺 */
    linear-gradient(rgba($primary-300,  .75), rgba($primary-300,  .75));
  background-clip: padding-box, padding-box;
  box-shadow: 0 1px 2px rgba(0,0,0,.04);
}

.progress-thin { 
  height: 6px; --bs-progress-bg: #{$primary-50}; 
}
.progress-thin .progress-bar { 
  --bs-progress-bar-bg:  #{$primary-500}; 
}
.icon-badge { 
  width:24px; 
  height:24px; 
  border-radius:50%; 
  background:$neutral-50; 
  box-shadow:0 2px 8px rgba(0,0,0,.08); }

/* 抽屜容器：固定在視窗底部，開啟時上滑到 top:67px */
.relax-panel{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  top: var(--panel-top);                 /* ▲ 由 JS 控制 */
  z-index: 1;                         
  display: flex; flex-direction: column; align-items: center;
  min-height: 0;            /* 讓子層可正確收縮（避免 Safari 撐開） */
  pointer-events: none;                 /* 先把事件交給內部 */
  transition: top .28s ease;
}
.relax-panel.is-open{} /* ▲ 只作狀態標記，位置由變數控制 */

/* 只調整 .scene-footer：當作抽屜的「頭」 */
.scene-footer{
  pointer-events: auto;
  width: 100%; max-width: 393px;
  background: transparent;
  position: static;   /* 取消你原本的 absolute */
  margin-bottom: 0;  /* 保險：清底部距離，確保「貼齊」 */
}

/* 抽屜內容：填滿剩餘高度並可捲動 */
.relax-panel .scene-body{
  pointer-events: auto;
  width: 100%; max-width: 393px;
  background: var(--panel-bg, var(--bs-body-bg, #fff)); /* 可覆寫底色 */
  border-radius: 0px 12px 0 0;
  
 /* 永遠緊貼在 .scene-footer 下方 */
  flex: 1 1 auto;
  min-height: 0;     /* 關鍵：避免內容把容器撐開 */
  overflow: auto;
}

 /* ▲ 展開時，底部導覽不吃點擊（避免擋抽屜） */
html.panel-open .nav-bottom,
html.panel-open footer { pointer-events:none; }

/* 若第二個 container 仍有 has-bottom-pad（給底部導覽預留），可視需要拿掉 */
.body.has-bottom-pad { padding-bottom: 108px; }

.body {
  height: auto;//暫訂
  background: $primary-50;
  // background:#{$primary-50};
}

.icon_cat_can {
  color: $neutral-500;  /* 因為 fill="currentColor" stroke="currentColor" */
  // color: #{$neutral-500};  /* 因為 fill="currentColor" stroke="currentColor" */
}

.icon_cat_can-max {
  color: $primary-600;  /* 因為 fill="currentColor" stroke="currentColor" */
  // color: #{$neutral-500};  /* 因為 fill="currentColor" stroke="currentColor" */
}

/*自訂shadow*/

.shadow-mini {
  box-shadow:0px 0px 4px rgba(0, 0, 0, 0.1) ; //custom
}

/* 自訂小圓角 */
$radius-xs: .25rem;
.rounded-top-m    { 
  border-top-left-radius: 16px !important; 
  border-top-right-radius: 16px !important; }
.rounded-bottom-xs { 
  border-bottom-left-radius: 8px !important; 
  border-bottom-right-radius: 8px !important; }

/* 參數 */
.accordion.accordion-flush {
  --acc-item-h: 143px;
  --acc-peek:   47px;
}

/* 讓 flush 也有邊與圓角、項目間留距 */
.accordion.accordion-flush {
  .accordion-item {
    height: var(--acc-item-h);
    background: $neutral-0;
    border: 1px solid var(--bs-border-color);
    overflow: hidden;              /* 讓圓角吃到內層 */
    position: relative;
  }

   /* 收折時堆疊，只露出 47px（限定「上一張是收折」才套負 margin）*/
  .accordion-item:not(:has(.accordion-collapse.show)) + .accordion-item {
    margin-top: calc(-1 * (var(--acc-item-h) - var(--acc-peek))); /* = -96px */
  }

  /* 標題高度=47px；去掉陰影與箭頭 */
  .accordion-button{
    min-height: var(--acc-peek);
    padding-top: .5rem; padding-bottom: .5rem;
    box-shadow: none;
    background-color: transparent !important;
  }
  
  .accordion-button::after{ display:none !important; }
  .accordion-body{ background-color: transparent !important; }

  /* 讓父層底色透出 */
  .accordion-button,
  .accordion-body { background-color: transparent !important; }
  .accordion-button { min-height: var(--acc-peek); padding-top:.5rem; padding-bottom:.5rem; box-shadow:none; }
}

/* 只有最後一張卡片用漸層 */
/* 改成只在「未展開(.acc-open)」時才套漸層 */
#accordionFlushExample:not(.acc-open) .accordion-item:last-child {
  background-color: #fff;
  --bs-gradient:
    radial-gradient(
      140% 140% at 0% 0%,
      #ffffff 0%,
      #ffffff 50%,
      rgba(223,240,183,.55) 70%,
      rgba(223,240,183,0) 100%
    ),
    radial-gradient(
      110% 110% at 100% 100%,
      rgba(255,246,0,.45) 0%,
      rgba(255,246,0,0) 60%
    );
  background-image: var(--bs-gradient);
  overflow: hidden;
}

/* ★修正：展開狀態樣式，移到頂層，避免寫成後代而失效 */
#accordionFlushExample.acc-open {
  .accordion-item {
    height: auto !important;            /* 展開不固定高 */
    background-image: none !important;  /* 展開取消漸層 */
    background-color: #fff !important;  /* 展開純白 */
  }
  .accordion-item + .accordion-item {
    margin-top: 8px !important;         /* 展開的卡片間距 8px */
  }
}

/* === add-photos：底層定位（Bottom Sheet 基礎） === */
.add-photos{
  position: fixed;
  left: 0; right: 0; bottom: -100%;    /* 收合先藏在視窗外 */
  max-width: 393px; margin: 0 auto;
  width: 100%;
  height: var(--sheet-h, 489px);
  z-index: 2005;                        /* 高於 relax-panel / footer sheet */
  display: grid;
  grid-template-rows: auto 1fr auto;    /* header / grid / footer */
  background: #fff;
  border-radius: 16px 16px 0 0;
  box-shadow: 0 -8px 24px rgba(0,0,0,.12);
  padding-bottom: env(safe-area-inset-bottom);
  transition: bottom .28s ease;
}
.add-photos.is-open{ bottom: 0; }

/* grid：3 欄、8px 間距、左右滿版無 padding */
.add-photos .ap-grid{
  list-style: none; margin: 0; padding: 8px 0 0 0; /* ★ 原本 8px 0 88px 0 → 改為 0 底 padding */
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;
  overflow: auto; min-height: 0;
}
.add-photos .ap-grid li{ position: relative; }
.add-photos .ap-grid img{
  display: block; width: 100%; height: auto;
}

/* ★ 覆蓋 CTA：置中疊在最後一列上方（中心在中間那張） */
.add-photos .ap-cta-overlay{
  position: absolute;
  left: 50%; transform: translateX(-50%);
  bottom: calc(env(safe-area-inset-bottom) + 46px);
  width: 260px; height: 40px; line-height: 1; /* 你指定的尺吋 */
  z-index: 2; /* 蓋在圖片上 */
  /* 可視需要加上陰影提升辨識度 */
  box-shadow: 0 4px 12px rgba(0,0,0,.15);
}

/* 選取態：框線 + 右上角順序徽章 */
.add-photos .ap-grid li.selected img{ outline: 2px solid var(--bs-primary-600, #BC8035); }
.add-photos .ap-grid .sel-badge{
  position: absolute; top: -1px; right: -1px; width: 22px; height: 22px;
  border-bottom-left-radius: 12px; display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 700; color: #fff; background: var(--bs-primary-600, #BC8035);
  box-shadow: 0 2px 6px rgba(0,0,0,.2);
}

.add-photos #add-photos-save[disabled]{ opacity: .5; pointer-events: none; }

/* 遮罩（若專案未全域定義） */
.sheet-backdrop{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.35);
  opacity: 0; pointer-events: none;
  transition: opacity .2s ease;
  z-index: 2004;                  /* 比抽屜低一層 */
}
.sheet-backdrop.show{ opacity: 1; pointer-events: auto; }

/* 上層：回填縮圖列（3 欄、8px 間距、有左右 padding） */
#uploaded-thumbs{
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;
}
#uploaded-thumbs img{
  width: 100%; height: auto; display: block; border-radius: 4px;
}

/* 保證有 hidden 屬性就真的隱藏（覆蓋 .d-flex !important） */
[hidden] { display: none !important; }

// 儲存筆記內容
.diary-textarea {
  min-height: 67px;
  resize: vertical;
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
}
.saved-list .diary-entry {
  white-space: pre-wrap;
  word-break: break-word;
  font-size: 0.875rem;
  color: var(--bs-primary-700, #1e3050);
  margin-bottom: .5rem;
} 

/*save視窗背景*/
.custom-modal-save {
  box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.1);
  width: 323px;
  margin: 0 auto;
}

/*save視窗背景*/
.custom-yellow-save {
  background-image: 
    url("/assets/images/overview/Ellipse 9.png"), /* 左上角圖片 */
    url("/assets/images/overview/Ellipse 8.png"); /* 右下角圖片 */
  
  background-repeat: no-repeat, no-repeat;         /* 分別設定不重複 */
  background-position: top left, bottom right;     /* 分別設定位置 */
  background-size: auto, auto;                     /* 分別設定大小，可改成 cover/contain */
}

/*tasks視窗背景*/
.custom-modal-tasks {
  box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.1);
  width: 346px;
  margin: 0 auto;
}

/*tasks視窗背景*/
.custom-yellow-tasks {
  background-image: 
    url("/assets/images/overview/Ellipse\ 8-big.png"); /* 右下角圖片 */
  
  background-repeat: no-repeat, no-repeat;         /* 分別設定不重複 */
  background-position: top left, bottom right;     /* 分別設定位置 */
  background-size: auto, auto;                     /* 分別設定大小，可改成 cover/contain */
}




/*z-index整理 
_footer.scss的bottom-nav(footer區塊)
--> 1030
_footer-breating.scss的bottom-sheet(footer區塊裡的呼吸抽屜功能)
--> 2000
_index.scss的relax-panel(index的我的放鬆旅程抽屜功能、edit-itinerary的編輯行程抽屜功能)
--> 1
_index.scss的breathing-exercises-edit.ejs的bottom-sheet-new(edit-itinerary的編輯行程內的新增/編輯呼吸屜功能)
--> 2
_index.scss的add-photos(新增照片抽屜)
--> 2005
_index.scss的sheet-backdrop(新增照片抽屜的遮罩)
--> 2004
_edit-itinerary的modal及modal-backdrop(edit-itinerary的編輯行程內的自訂+彈出視窗用(myday-diary-template.ejs))
--> 2010

_settingAccount的loginAccount的span
--> 1
_settingNewbieGuide的full-screen-page
--> 1

*/